{
  "name": "SpellTest",
  "type": "equippableItem",
  "_id": "vXPXJ1UQYp79cqid",
  "img": "icons/svg/item-bag.svg",
  "system": {
    "body": {
      "contents": [
        {
          "key": "",
          "colSpan": 1,
          "rowSpan": 1,
          "cssClass": "sinlesscsb-marker",
          "role": 0,
          "editRole": 0,
          "permission": 0,
          "tooltip": "",
          "visibilityFormula": "",
          "editableFormula": "",
          "escapeHTML": false,
          "type": "panel",
          "contents": [
            {
              "key": "",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "label",
              "size": "full-size",
              "icon": "star",
              "value": "${actionLabel ? actionLabel : \"Cast\"}$",
              "prefix": "",
              "suffix": "",
              "rollMessage": "%{\n  // Prefer linkedEntity (inventory row) then entity (item sheet)\n  const doc = (typeof linkedEntity !== \"undefined\" && linkedEntity) ? linkedEntity\n            : (typeof entity !== \"undefined\" && entity) ? entity\n            : null;\n\n  const itemUuid = String(doc?.uuid ?? \"\").trim();\n\n  // Actor resolution: embedded parent wins; otherwise token/character fallbacks.\n  const embeddedActorUuid =\n    (doc?.parent?.documentName === \"Actor\" && doc?.parent?.uuid) ? String(doc.parent.uuid) : \"\";\n\n  const scopeActorUuid =\n    (typeof actor !== \"undefined\" && actor?.documentName === \"Actor\" && actor?.uuid) ? String(actor.uuid) : \"\";\n\n  const controlledActorUuid = (() => {\n    const t = canvas?.tokens?.controlled?.[0];\n    return t?.actor?.uuid ? String(t.actor.uuid) : \"\";\n  })();\n\n  const targetedActorUuid = (() => {\n    const t = game.user?.targets ? Array.from(game.user.targets)[0] : null;\n    return t?.actor?.uuid ? String(t.actor.uuid) : \"\";\n  })();\n\n  const userCharUuid = game.user?.character?.uuid ? String(game.user.character.uuid) : \"\";\n\n  const actorUuid = String(\n    embeddedActorUuid ||\n    scopeActorUuid ||\n    controlledActorUuid ||\n    targetedActorUuid ||\n    userCharUuid ||\n    \"\"\n  ).trim();\n\n  if (!itemUuid) {\n    ui.notifications?.warn?.(\"SinlessCSB: missing spell item context (itemUuid).\");\n    return \"\";\n  }\n\n  if (!actorUuid) {\n    ui.notifications?.warn?.(\"SinlessCSB: No actor context. Control or target a token, then try again.\");\n    return \"\";\n  }\n\n  const api = game.modules.get(\"sinlesscsb\")?.api;\n  if (typeof api?.castSpell !== \"function\") {\n    ui.notifications?.error?.(\"SinlessCSB: castSpell API not available (module not ready / not exposed).\");\n    return \"\";\n  }\n\n  api.castSpell({ itemUuid, actorUuid });\n  return \"\";\n}%\n",
              "altRollMessage": "",
              "rollMessageToChat": false,
              "altRollMessageToChat": false,
              "style": "button"
            }
          ],
          "flow": "vertical",
          "align": "center",
          "verticalAlign": "top",
          "collapsible": false,
          "defaultCollapsed": false,
          "title": "",
          "titleStyle": "default"
        },
        {
          "key": "",
          "colSpan": 1,
          "rowSpan": 1,
          "cssClass": "",
          "role": 0,
          "editRole": 0,
          "permission": 0,
          "tooltip": "",
          "visibilityFormula": "",
          "editableFormula": "",
          "escapeHTML": false,
          "type": "panel",
          "contents": [
            {
              "key": "spellRulestext",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "textArea",
              "size": "full-size",
              "label": "Spell Rules",
              "defaultValue": "<p>Paste text from book / other useful info here.</p>",
              "style": "sheet"
            }
          ],
          "flow": "horizontal",
          "align": "left",
          "verticalAlign": "top",
          "collapsible": true,
          "defaultCollapsed": true,
          "title": "Rules Text",
          "titleStyle": "default"
        },
        {
          "key": "",
          "colSpan": 1,
          "rowSpan": 1,
          "cssClass": "",
          "role": 0,
          "editRole": 0,
          "permission": 0,
          "tooltip": "",
          "visibilityFormula": "",
          "editableFormula": "",
          "escapeHTML": false,
          "type": "panel",
          "contents": [
            {
              "key": "actionLabel",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "textField",
              "size": "full-size",
              "label": "actionLabel",
              "defaultValue": "Cast",
              "charList": "",
              "maxLength": null,
              "autocomplete": ""
            },
            {
              "key": "",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "panel",
              "contents": [
                {
                  "key": "spellforceDefault",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "Spell Force (Default)",
                  "defaultValue": "1",
                  "allowDecimal": false,
                  "minVal": "1",
                  "maxVal": "${spellforceMax}$",
                  "allowRelative": false,
                  "showControls": true,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                },
                {
                  "key": "spellforceMax",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "Force Rating (MAX Learned)",
                  "defaultValue": "1",
                  "allowDecimal": false,
                  "minVal": "1",
                  "maxVal": "",
                  "allowRelative": false,
                  "showControls": true,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                },
                {
                  "key": "spellFociRank",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "Foci Rank",
                  "defaultValue": "1",
                  "allowDecimal": false,
                  "minVal": "1",
                  "maxVal": "",
                  "allowRelative": false,
                  "showControls": true,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                },
                {
                  "key": "forceCost",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "Cost (per lvl Force)",
                  "defaultValue": "",
                  "allowDecimal": false,
                  "minVal": "0",
                  "maxVal": "",
                  "allowRelative": false,
                  "showControls": false,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                },
                {
                  "key": "fetishRank",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "Fetish Rank",
                  "defaultValue": "0",
                  "allowDecimal": false,
                  "minVal": "0",
                  "maxVal": "",
                  "allowRelative": false,
                  "showControls": true,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                },
                {
                  "key": "bonusDice",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "bonusDice",
                  "defaultValue": "0",
                  "allowDecimal": false,
                  "minVal": "",
                  "maxVal": "",
                  "allowRelative": false,
                  "showControls": false,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                },
                {
                  "key": "spellDuration",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "textField",
                  "size": "full-size",
                  "label": "Duration",
                  "defaultValue": "Instantaneous",
                  "charList": "",
                  "maxLength": null,
                  "autocomplete": ""
                },
                {
                  "key": "diceMod",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "diceMod",
                  "defaultValue": "0",
                  "allowDecimal": false,
                  "minVal": "",
                  "maxVal": "",
                  "allowRelative": false,
                  "showControls": false,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                },
                {
                  "key": "spellArea",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "textField",
                  "size": "full-size",
                  "label": "Area",
                  "defaultValue": "Single",
                  "charList": "",
                  "maxLength": null,
                  "autocomplete": ""
                },
                {
                  "key": "fociCost",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "Foci Cost (per lvl)",
                  "defaultValue": "1000",
                  "allowDecimal": false,
                  "minVal": "",
                  "maxVal": "",
                  "allowRelative": false,
                  "showControls": true,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                },
                {
                  "key": "spellResistance",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "textField",
                  "size": "full-size",
                  "label": "Target Resistance",
                  "defaultValue": "Brawn Pool",
                  "charList": "",
                  "maxLength": null,
                  "autocomplete": ""
                },
                {
                  "key": "fetishCost",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "numberField",
                  "size": "full-size",
                  "label": "Fetish Cost (per lvl)",
                  "defaultValue": "1000",
                  "allowDecimal": false,
                  "minVal": "",
                  "maxVal": "",
                  "allowRelative": false,
                  "showControls": false,
                  "controlsStyle": "hover",
                  "controlsCustomIncrements": "",
                  "inputStyle": "text"
                }
              ],
              "flow": "grid-2",
              "align": "left",
              "verticalAlign": "top",
              "collapsible": false,
              "defaultCollapsed": false,
              "title": "",
              "titleStyle": "default"
            },
            {
              "key": "drainFormula",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "textField",
              "size": "full-size",
              "label": "Drain Formula",
              "defaultValue": "1 + (Force/2) ---example, REPLACE with correct formula---",
              "charList": "",
              "maxLength": null,
              "autocomplete": ""
            },
            {
              "key": "",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "panel",
              "contents": [
                {
                  "key": "exampleForce",
                  "colSpan": 1,
                  "rowSpan": 1,
                  "cssClass": "",
                  "role": 0,
                  "editRole": 0,
                  "permission": 0,
                  "tooltip": "",
                  "visibilityFormula": "",
                  "editableFormula": "",
                  "escapeHTML": false,
                  "type": "textArea",
                  "size": "full-size",
                  "label": "",
                  "defaultValue": "<ol><li data-start=\"5936\" data-end=\"6018\"><p data-start=\"5938\" data-end=\"5952\">Use <code data-start=\"5906\" data-end=\"5913\">Force</code> for the chosen Force.</p><p></p></li><li data-start=\"5936\" data-end=\"6018\"><p data-start=\"5938\" data-end=\"5952\">Allowed example forms:</p><ul data-start=\"5955\" data-end=\"6018\"><li data-start=\"5955\" data-end=\"5968\"><p data-start=\"5957\" data-end=\"5968\"><code data-start=\"5957\" data-end=\"5968\">3 + Force</code></p></li><li data-start=\"5971\" data-end=\"5988\"><p data-start=\"5973\" data-end=\"5988\"><code data-start=\"5973\" data-end=\"5988\">1 + (Force/2)</code></p></li><li data-start=\"5991\" data-end=\"6004\"><p data-start=\"5993\" data-end=\"6004\"><code data-start=\"5993\" data-end=\"6004\">(Force/2)</code></p><p data-start=\"6021\" data-end=\"6098\"></p></li></ul></li></ol>",
                  "style": "sheet"
                }
              ],
              "flow": "horizontal",
              "align": "left",
              "verticalAlign": "top",
              "collapsible": true,
              "defaultCollapsed": false,
              "title": "Drain Formula Syntax Guidelines",
              "titleStyle": "default"
            },
            {
              "key": "spellTags",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "textField",
              "size": "full-size",
              "label": "Tags",
              "defaultValue": "",
              "charList": "",
              "maxLength": null,
              "autocomplete": ""
            }
          ],
          "flow": "vertical",
          "align": "left",
          "verticalAlign": "top",
          "collapsible": true,
          "defaultCollapsed": false,
          "title": "Roll Config",
          "titleStyle": "default"
        },
        {
          "key": "",
          "colSpan": 1,
          "rowSpan": 1,
          "cssClass": "",
          "role": 4,
          "editRole": 0,
          "permission": 0,
          "tooltip": "",
          "visibilityFormula": "",
          "editableFormula": "",
          "escapeHTML": false,
          "type": "panel",
          "contents": [
            {
              "key": "spellCategory",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "textField",
              "size": "full-size",
              "label": "Category",
              "defaultValue": "Combat",
              "charList": "",
              "maxLength": null,
              "autocomplete": ""
            },
            {
              "key": "drainForceMult",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "numberField",
              "size": "full-size",
              "label": "Drain xForce",
              "defaultValue": "1",
              "allowDecimal": true,
              "minVal": "0",
              "maxVal": "",
              "allowRelative": false,
              "showControls": true,
              "controlsStyle": "hover",
              "controlsCustomIncrements": "",
              "inputStyle": "text"
            },
            {
              "key": "skillKey",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "textField",
              "size": "full-size",
              "label": "skillKey",
              "defaultValue": "Skill_Sorcery",
              "charList": "",
              "maxLength": null,
              "autocomplete": ""
            },
            {
              "key": "poolKey",
              "colSpan": 1,
              "rowSpan": 1,
              "cssClass": "",
              "role": 0,
              "editRole": 0,
              "permission": 0,
              "tooltip": "",
              "visibilityFormula": "",
              "editableFormula": "",
              "escapeHTML": false,
              "type": "textField",
              "size": "full-size",
              "label": "poolKey",
              "defaultValue": "Resolve",
              "charList": "",
              "maxLength": null,
              "autocomplete": ""
            }
          ],
          "flow": "grid-2",
          "align": "center",
          "verticalAlign": "top",
          "collapsible": true,
          "defaultCollapsed": true,
          "title": "hidden",
          "titleStyle": "default"
        }
      ],
      "key": "custom_body",
      "type": "panel"
    },
    "display": {
      "width": 600,
      "height": 600,
      "fix_size": false,
      "pp_width": 200,
      "pp_height": 200
    },
    "header": {
      "contents": [],
      "key": "custom_header",
      "type": "panel"
    },
    "hidden": [],
    "modifiers": [],
    "props": {
      "actionLabel": "Cast",
      "skillKey": "Skill_Sorcery",
      "poolKey": "Resolve",
      "spellFociRank": "5",
      "bonusDice": "0",
      "diceMod": "0",
      "spellforceMax": "5",
      "spellforceDefault": "3",
      "fetishRank": "3",
      "drainFormula": "1 + (Force/2)",
      "exampleForce": "<ol><li data-start=\"5936\" data-end=\"6018\"><p data-start=\"5938\" data-end=\"5952\">Use <code data-start=\"5906\" data-end=\"5913\">Force</code> for the chosen Force.</p><p></p></li><li data-start=\"5936\" data-end=\"6018\"><p data-start=\"5938\" data-end=\"5952\">Allowed example forms:</p><ul data-start=\"5955\" data-end=\"6018\"><li data-start=\"5955\" data-end=\"5968\"><p data-start=\"5957\" data-end=\"5968\"><code data-start=\"5957\" data-end=\"5968\">3 + Force</code></p></li><li data-start=\"5971\" data-end=\"5988\"><p data-start=\"5973\" data-end=\"5988\"><code data-start=\"5973\" data-end=\"5988\">1 + (Force/2)</code></p></li><li data-start=\"5991\" data-end=\"6004\"><p data-start=\"5993\" data-end=\"6004\"><code data-start=\"5993\" data-end=\"6004\">(Force/2)</code></p><p data-start=\"6021\" data-end=\"6098\"></p></li></ul></li></ol>",
      "spellDuration": "Instantaneous",
      "spellArea": "Single",
      "spellRulestext": "<p>Paste text from book / other useful info here.  Testadd</p><p></p>",
      "spellResistance": "Brawn",
      "spellCategory": "Combat",
      "drainForceMult": "1",
      "spellTags": "",
      "fociCost": "1000",
      "fetishCost": "1000",
      "forceCost": ""
    },
    "unique": false,
    "uniqueId": "vXPXJ1UQYp79cqid",
    "template": "SpelTplSinlssA1X",
    "templateSystemUniqueVersion": 1247909274
  },
  "effects": [],
  "folder": "fzpbw6RIBAzBp9kN",
  "flags": {
    "custom-system-builder": {
      "version": "5.1.0"
    }
  },
  "_stats": {
    "compendiumSource": null,
    "duplicateSource": null,
    "exportSource": {
      "worldId": "sinless",
      "uuid": "Item.vXPXJ1UQYp79cqid",
      "coreVersion": "13.351",
      "systemId": "custom-system-builder",
      "systemVersion": "5.1.0"
    },
    "coreVersion": "13.351",
    "systemId": "custom-system-builder",
    "systemVersion": "5.1.0",
    "createdTime": 1768061787442,
    "modifiedTime": 1770006351154,
    "lastModifiedBy": "KoiB8oaGNkPdgzdM"
  },
  "items": [],
  "ownership": {
    "default": 0
  }
}